## Управление колонками AmoCRM:

1. Колонки которые нужны клиенту AmoCRM находятся в папке *amocrm -> columns.py -> columns_leads*:
   Обязательные колонки (их не трогать) -> **'id'**, остальные можно менять под клиента.
*columns_events* Обязательные колонки (их не трогать) -> **'entity_id', 'created_at', 'value_after.id'**, остальные 
можно менять под клиента.
2. В том же файле, см. пункт 1, в переменной _replace_dict_events_ хранятся этапы, каждый клиент имеет свои этапы.
   Инструкция получения этапов из AmoCRM по ссылке: [Ссылка](https://drive.google.com/file/d/13eTFCAI3mIvxIQJov1_eAMksWP2VIVMs/view?usp=share_link). Менять их нужно "Ключ": "Значение"!


## Где взять данные AmoCRM:
1. Выгрузка проекта с github;
2. Заходим в AmoMarket;
3. Установленные;
4. Создать интеграцию;    
5. Внешняя интеграция → Создать;
6. Вставляем ссылку на сайт интеграции;
7. Поставить галочку предоставлять доступ → Все!
8. Назвать Python_API;
9. Описание → Интеграция по API;
10. Сохраняем → Заходим в интеграцию;
11. Снова открываем приложение и закрываем;
12. Обновляем страницу;
13. Ключи и доступы → Получаем ключи доступа к AmoCRM;
14. Замена данных в .env;
15. *CLIENT_ID*=your_client_id → ID интеграции:
16. *CLIENT_SECRET*=your_client_secret → Секретный ключ;
17. *REFRESH_TOKEN*=your_refresh_token → Код авторизации который 20-ти минутный;
18. *REDIRECT_URI*=https://your_uri.test/ → Перенаправить пользователя на сайт компании;
19. *SUBDOMAIN*=your_domain → Ссылка на пользователя, без https://. (example.acomcrm.ru);
20. Важно успеть сделать это всё за 20 минут, в противном случае вы умрёте. (ТОРОПИСЬ, ВРЕМЯ ПОШЛО!!!)
21. В папке amocrm → drop_columns.py поменять этапы сделок


## Инструкция по заполнению данных файла .env:

1. Зайдите в файл AmoCRM_API и введите значение для переменной SUBDOMAIN. Замените "your_domain" на ваш домен.
2. Найдите переменную CLIENT_ID и замените значение "your_client_id" на ваш клиентский идентификатор AmoCRM.
3. В переменной CLIENT_SECRET замените "your_client_secret" на ваш секретный ключ клиента AmoCRM.
4. В переменной REDIRECT_URI замените "https://your_uri.test/" на вашу перенаправляющую ссылку.
5. Значение переменных TOKEN_TYPE и ACCESS_TOKEN будет получено автоматически.
6. Замените значение переменной REFRESH_TOKEN на ваш токен обновления.

7. В файле YandexAPI найдите переменную REPORTS_URL и замените значение
   на "https://api.direct.yandex.com/json/v5/reports".
8. Замените "your_token_yandex" в переменной TOKEN_YANDEX на ваш токен YandexAPI.
9. Замените "your_login_yandex" в переменной LOGIN_YANDEX на ваш логин YandexAPI.

10. В разделе DB найдите переменную USER_DB и замените "user_database" на имя вашего пользователя базы данных.
11. В переменной PASSWORD_DB замените "password_database" на ваш пароль от базы данных.
12. Замените "ip_address_database" в переменной ADDRESS_DB на IP-адрес вашей базы данных.
13. Замените "port_database" в переменной PORT_DB на порт вашей базы данных.
14. В переменной NAME_DB замените "name_database" на имя вашей базы данных.

15. В разделе AmoDates найдите переменную NOW_DATE_AMO и замените значение "2023-08-23" на текущую дату.
16. В переменной LAST_DATE_AMO замените "2023-06-01" на дату начала.

17. В разделе YandexDates найдите переменную NOW_DATE_YANDEX и замените значение "2023-08-25" на текущую дату.
18. В переменной LAST_DATE_YANDEX замените "2023-06-01" на дату начала.

19. В разделе YandexDatas найдите переменную GOALS_ID и замените "your_goals_id" на ваш идентификатор цели.
20. Значение переменной COLUMNS_YANDEX должно содержать список нужных вам данных, разделенных запятой.

21. Сохраните все изменения файлов.

Примечание: При замене значений переменных убедитесь, что вы вводите правильные данные и не удаляете кавычки или другие
символы, которые необходимы для правильной работы кода.

## Инструкция по заполнению значений файла Dockerfile и run_program.py:

* В файле нужно поменять рабочую директорию проекта - WORKDIR /your_client_name. Меняем на название клиента!

* В файле с запуском программы вместо значения - your_client_name должно стоять название директории такое же как в
  Dockerfile: WORKDIR /your_client_name, это название рабочей директории.
* Пример, WORKDIR /technoshark - Dockerfile, 'python3', '/technoshark/tokens.py'
  'python3', '/technoshark/main.py'

## Работа с tokens.py:

После заполнения основных конфигурационных файлов, нужно получить access_token AmoCRM вручную. С этим поможет файл
tokens.py,
нужно раскомментировать функцию get_access_token (если она закомментирована), достаточно удалить # перед функцией и
наоборот закомментировать функцию auth. После чего запустить файл tokens.py и сделать обратные действия. В итоге функция
auth должна быть раскомментировала перед загрузкой на сервер, а функция get_access_token наоборот закомментирована.
P.S. Проверить наличие access_token в .env файле.

# Запуск проекта на сервере!


# Система создания новой базы данных:

1. Замена названия рабочей директории в Dockerfile → *WORKDIR /your_client_name*
2. Замена названия куда копируются файлы внутри Docker → *COPY* run.sh */your_client_name/*
3. Замена директории для кого можно запускать файл → *RUN chmod +*x */client_name/*run.sh
4. Поменять данные к базе данных которую мы создали, создаётся вручную через PGADMIN4, Пароли у Сис. админа.
- Открыть папку проекта;
- Вести команду сборки приложения в Докере: docker build -t your_name_container .
- Вести команду запуска приложения в Докере: docker run -d --restart=always --name your_name_container your_name_image
- Проверка выгрузки на следующий день.

## Методы подключения к серверу, основные программы и методы.

- Putty, настройка внутри подключение к серверу, В данный момент подключение осуществляется с помощью ssh ключа.
- Filezilla установка и настройка подключения, В данный момент подключение осуществляется с помощью ssh ключа.